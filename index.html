<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inheritance Tax Rates Worldwide</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        h1 {
            font-size: 28px;
            color: #333;
            margin-top: 20px;
        }
        p {
            font-size: 16px;
            color: #666;
            max-width: 800px;
            margin: 0 auto 20px;
        }
        #map {
            width: 85%;
            height: 550px;
            margin: auto;
            border: 2px solid #ccc;
            border-radius: 10px;
            box-shadow: 0px 4px 8px rgba(0,0,0,0.2);
        }
        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: white;
            padding: 12px;
            border-radius: 8px;
            font-size: 14px;
            box-shadow: 0px 2px 5px rgba(0,0,0,0.2);
            line-height: 18px;
            text-align: left;
        }
        .legend-title {
            font-weight: bold;
            font-size: 16px;
        }
        .gradient-bar {
            width: 180px;
            height: 12px;
            background: linear-gradient(to right, #ffffff, #fee08b, #fc8d59, #d73027);
            border-radius: 5px;
        }
        .gradient-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-top: 4px;
        }
    </style>
</head>
<body>

    <h1>Inheritance Tax Rates Worldwide</h1>
    <p>This map highlights countries with varying inheritance tax rates. Darker shades represent higher tax rates, while white indicates no inheritance tax.</p>

    <!-- Map Container -->
    <div id="map"></div>

    <!-- Legend -->
    <div class="legend">
        <div class="legend-title">Inheritance Tax Rate (%)</div>
        <div class="gradient-bar"></div>
        <div class="gradient-labels">
            <span>0%</span>
            <span>55%</span>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!-- D3.js for color scales -->
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

    <script>
        // Initialize the map with zoom and panning disabled
        var map = L.map('map', {
            center: [20, 0],
            zoom: 2,
            zoomControl: false,
            scrollWheelZoom: false,
            doubleClickZoom: false,
            dragging: false // Disables panning
        });

        // Use a high-contrast map with labeled country names (not continents)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap & CartoDB contributors'
        }).addTo(map);

        // Overlay country names separately to ensure visibility
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}{r}.png', {
            attribution: ''
        }).addTo(map);

        // Define color scale based on inheritance tax rates
        var colorScale = d3.scaleSequential(d3.interpolateReds)
            .domain([0, 55]); // 0% to 55%

        // Country Data: [Name, Tax Rate, Extra Info]
        var countries = {
            "Japan": { "taxRate": 55, "info": "Highest tax globally" },
            "South Korea": { "taxRate": 50, "info": "Strict inheritance rules" },
            "France": { "taxRate": 45, "info": "Progressive taxation" },
            "United Kingdom": { "taxRate": 40, "info": "Nil Rate Band: £325K" },
            "United States": { "taxRate": 40, "info": "Exemption: $13.61M estate" },
            "Spain": { "taxRate": 34, "info": "Regional variations apply" },
            "Netherlands": { "taxRate": 20, "info": "Tax reliefs for direct heirs" },
            "Germany": { "taxRate": 30, "info": "Up to €400K exemption" },
            "Italy": { "taxRate": 8, "info": "Rates 4%-8% based on relationship" },
            "Switzerland": { "taxRate": 40, "info": "Varies by canton" },
            "Denmark": { "taxRate": 36, "info": "Rates up to 36.25%" },
            "Norway": { "taxRate": 0, "info": "Abolished in 2014" },
            "Sweden": { "taxRate": 0, "info": "Abolished in 2005" },
            "Canada": { "taxRate": 0, "info": "No inheritance tax" },
            "Australia": { "taxRate": 0, "info": "No inheritance tax" },
            "China": { "taxRate": 0, "info": "No inheritance tax" }
        };

        // Fetch GeoJSON data for world countries
        fetch('https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json')
            .then(response => response.json())
            .then(geoData => {
                L.geoJson(geoData, {
                    style: function(feature) {
                        var countryName = feature.properties.name;
                        var taxRate = countries[countryName] ? countries[countryName].taxRate : 0;
                        return {
                            fillColor: colorScale(taxRate),
                            weight: 1,
                            opacity: 1,
                            color: '#333',
                            fillOpacity: 0.8
                        };
                    },
                    onEachFeature: function(feature, layer) {
                        var countryName = feature.properties.name;
                        if (countries[countryName]) {
                            var taxInfo = countries[countryName].info;
                            var taxRate = countries[countryName].taxRate;
                            layer.bindPopup(`<strong>${countryName}</strong><br>Tax Rate: ${taxRate}%<br>${taxInfo}`);
                        }
                    }
                }).addTo(map);
            });

    </script>

</body>
</html>

